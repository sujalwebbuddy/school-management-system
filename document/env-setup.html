<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Environment Variables Setup ‚Äì SchoolHub Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="./styles.css" />
    <script defer src="./script.js"></script>
  </head>
  <body>
    <aside class="sidebar">
      <div class="brand">
        <img src="./screenshots/logo.svg" alt="SchoolHub Logo" />
        <div>
          <h1>SchoolHub Platform</h1>
          <p>Documentation v1.0</p>
        </div>
      </div>
      <nav>
        <a href="./index.html">Welcome</a>
        <a href="./how-to-use.html">User Guide</a>
        <a href="./push-to-github.html">How to push to GitHub</a>
        <a href="./install-vercel.html">How to install on Vercel</a>
        <a href="./install-aws-ec2.html">How to install on AWS EC2</a>
        <a href="./database.html">How to setup Authentication</a>
        <a href="./mongodb-setup.html">How to create MongoDB Database</a>
        <a class="active" href="./env-setup.html">Environment Variables</a>
        <a href="./frontend-updates.html">Frontend Customization</a>
        <a href="./pricing-and-validations.html">Edit pricing & validations</a>
      </nav>
      <footer>
        <small>Built with MERN Stack (MongoDB, Express, React, Node.js)</small>
      </footer>
    </aside>

    <main class="content">
      <header class="topbar">
        <h2>Environment Variables Setup</h2>
      </header>

      <section class="prose">
        <div class="callout info">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg> Environment Configuration:</strong> Set up all required environment variables for SchoolHub Platform v1.0. This includes database connections, JWT secrets, and server configurations for the MERN stack application.
        </div>

        <h2><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg> Complete .env.local Template</h2>

        <div class="callout warning">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg> Security Note:</strong> Never commit your .env.local file to version control. Add it to your .gitignore file to keep your secrets safe.
        </div>

        <pre><code># -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
PORT=5000
NODE_ENV=development

# -----------------------------------------------------------------------------
# Database Configuration (MongoDB)
# Use MongoDB Atlas for cloud database or local MongoDB installation
# -----------------------------------------------------------------------------
MONGODB_URI=mongodb://localhost:27017/schoolhub
# For MongoDB Atlas: mongodb+srv://username:password@cluster.mongodb.net/schoolhub

# -----------------------------------------------------------------------------
# JWT Authentication
# Generate a secure secret: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# -----------------------------------------------------------------------------
JWT_SECRET=your_super_secure_jwt_secret_here_min_32_characters
JWT_EXPIRE=7d

# -----------------------------------------------------------------------------
# File Upload Configuration
# -----------------------------------------------------------------------------
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf,text/plain

# -----------------------------------------------------------------------------
# Email Configuration (Optional - for notifications)
# -----------------------------------------------------------------------------
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your_email@gmail.com
EMAIL_PASS=your_app_password
EMAIL_FROM=SchoolHub Platform &lt;noreply@schoolhub.com&gt;

# -----------------------------------------------------------------------------
# Client Configuration
# -----------------------------------------------------------------------------
REACT_APP_API_URL=http://localhost:5000/api
REACT_APP_SOCKET_URL=http://localhost:5000

# -----------------------------------------------------------------------------
# Admin Setup
# -----------------------------------------------------------------------------
DEFAULT_ADMIN_EMAIL=admin@schoolhub.com
DEFAULT_ADMIN_PASSWORD=change_this_password_after_first_login

# -----------------------------------------------------------------------------
# Security Configuration
# -----------------------------------------------------------------------------
BCRYPT_ROUNDS=12
CORS_ORIGIN=http://localhost:3000
</code></pre>

        <h2>üîë Required vs Optional Variables</h2>

        <h3><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Required for Basic Functionality</h3>
        <div class="callout danger">
          <strong>Critical Variables:</strong> The application will not function without these
          <ul>
            <li><code>MONGODB_URI</code> - MongoDB connection string (local or Atlas)</li>
            <li><code>JWT_SECRET</code> - Secret key for JWT token signing (minimum 32 characters)</li>
            <li><code>PORT</code> - Server port (default: 5000)</li>
            <li><code>NODE_ENV</code> - Environment mode (development/production)</li>
            <li><code>DEFAULT_ADMIN_EMAIL</code> - Email for initial admin account creation</li>
            <li><code>DEFAULT_ADMIN_PASSWORD</code> - Password for initial admin account (change after first login)</li>
          </ul>
        </div>

        <h3><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg> Optional for Enhanced Features</h3>
        <ul>
          <li><code>EMAIL_HOST</code> - SMTP server for email notifications (default: smtp.gmail.com)</li>
          <li><code>EMAIL_PORT</code> - SMTP port (default: 587)</li>
          <li><code>EMAIL_USER</code> - SMTP authentication username</li>
          <li><code>EMAIL_PASS</code> - SMTP authentication password (use app password for Gmail)</li>
          <li><code>EMAIL_FROM</code> - Sender email address for notifications</li>
          <li><code>UPLOAD_PATH</code> - Directory for file uploads (default: ./uploads)</li>
          <li><code>MAX_FILE_SIZE</code> - Maximum file size in bytes (default: 10MB)</li>
          <li><code>ALLOWED_FILE_TYPES</code> - Comma-separated list of allowed MIME types</li>
        </ul>

        <h2><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><circle cx="12" cy="16" r="1"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg> Database Setup (MongoDB)</h2>

        <h3>MongoDB Setup Options</h3>

        <h4>Option 1: Local MongoDB Installation</h4>
        <ol>
          <li><strong>Install MongoDB:</strong> Download and install MongoDB Community Server from <a href="https://www.mongodb.com/try/download/community" target="_blank">mongodb.com</a></li>
          <li><strong>Start MongoDB:</strong> Run <code>mongod</code> to start the MongoDB service</li>
          <li><strong>Set Connection:</strong> Use <code>MONGODB_URI=mongodb://localhost:27017/schoolhub</code></li>
        </ol>

        <h4>Option 2: MongoDB Atlas (Cloud)</h4>
        <ol>
          <li><strong>Create Account:</strong> Sign up at <a href="https://cloud.mongodb.com/" target="_blank">MongoDB Atlas</a></li>
          <li><strong>Create Cluster:</strong> Choose a free tier cluster</li>
          <li><strong>Get Connection String:</strong> Copy the connection string from Atlas dashboard</li>
          <li><strong>Update URI:</strong> Replace username/password and database name in the connection string</li>
        </ol>
        </ol>

        <h2><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4v16l16-8L4 4z"/></svg> Quick Start Guide</h2>

        <h3>Setting up SchoolHub for Development</h3>
        <ol>
          <li><strong>Clone Repository:</strong> <code>git clone &lt;repository-url&gt;</code></li>
          <li><strong>Install Dependencies:</strong>
            <ul>
              <li><code>cd server && npm install</code></li>
              <li><code>cd ../client && npm install</code></li>
            </ul>
          </li>
          <li><strong>Setup Environment:</strong> Copy <code>.env.example</code> to <code>.env</code> and configure variables</li>
          <li><strong>Start MongoDB:</strong> Ensure MongoDB is running locally or configure Atlas connection</li>
          <li><strong>Start Services:</strong>
            <ul>
              <li><code>cd server && npm start</code> (backend on port 5000)</li>
              <li><code>cd client && npm start</code> (frontend on port 3000)</li>
            </ul>
          </li>
          <li><strong>Create Admin:</strong> Run <code>npm run create-admin</code> in server directory</li>
          <li><strong>Access Application:</strong> Open <code>http://localhost:3000</code> in your browser</li>
        </ol>

        <div class="callout success">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg> First Login:</strong>
          <ul>
            <li>Use the admin credentials created during setup</li>
            <li>Change the default password immediately after login</li>
            <li>Start by approving teacher registrations</li>
            <li>Create classes and assign subjects to teachers</li>
          </ul>
        </div>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="7.5 4.27 12 6.11 16.5 4.27"/><polyline points="7.5 19.73 12 21.57 16.5 19.73"/><line x1="12" y1="6.11" x2="12" y2="21.57"/></svg> Deployment Checklist</h2>


        <h3>JWT Authentication Setup</h3>
        <ol>
          <li><strong>Generate JWT Secret:</strong>
            <ul>
              <li>Run: <code>node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"</code></li>
              <li>Or use any secure random string generator (minimum 32 characters)</li>
              <li>Copy the generated secret</li>
            </ul>
          </li>
          <li><strong>Add to .env:</strong> Set as <code>JWT_SECRET</code></li>
          <li><strong>Set JWT_EXPIRE:</strong> Configure token expiration (default: 7d)</li>
        </ol>

        <div class="callout warning">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg> Security Critical:</strong> Keep your JWT_SECRET secure and never commit it to version control.
        </div>

        <h3>Email Configuration (Optional)</h3>
        <ol>
          <li><strong>Gmail Setup:</strong>
            <ul>
              <li>Enable 2-factor authentication on your Gmail account</li>
              <li>Generate an App Password: <a href="https://support.google.com/accounts/answer/185833" target="_blank">Google Help</a></li>
              <li>Use your Gmail address as EMAIL_USER</li>
              <li>Use the App Password as EMAIL_PASS</li>
            </ul>
          </li>
          <li><strong>Other SMTP:</strong> Configure any SMTP server settings as needed</li>
          <li><strong>Test Configuration:</strong> Send a test email to verify setup</li>
        </ol>

        <h2>üìß Email Setup (SMTP)</h2>

        <h3>SMTP Configuration for Password Reset Emails</h3>
        <p>The application uses SMTP to send password reset emails. Configure these variables to enable email functionality:</p>
        <ol>
          <li><strong>SMTP Host:</strong> Set <code>SMTP_HOST</code> to your email provider's SMTP server (default: <code>smtp.gmail.com</code> for Gmail)</li>
          <li><strong>SMTP Port:</strong> Set <code>SMTP_PORT</code> to the SMTP port (default: <code>587</code> for TLS)</li>
          <li><strong>SMTP Credentials:</strong>
            <ul>
              <li>Set <code>SMTP_USER</code> to your email address</li>
              <li>Set <code>SMTP_PASSWORD</code> to your email password or app-specific password</li>
            </ul>
          </li>
          <li><strong>From Email:</strong> Set <code>SMTP_FROM_EMAIL</code> to the email address that will appear as the sender (defaults to <code>SMTP_USER</code> if not set)</li>
        </ol>

        <div class="callout info">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><circle cx="12" cy="16" r="1"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg> Gmail Setup Tips:</strong>
          <ul>
            <li>For Gmail, you'll need to use an <a href="https://support.google.com/accounts/answer/185833" target="_blank">App Password</a> instead of your regular password</li>
            <li>Enable 2-Step Verification first, then generate an app password</li>
            <li>Use the app password as your <code>SMTP_PASSWORD</code></li>
            <li>If SMTP is not configured, password reset emails will be logged to console in development mode</li>
          </ul>
        </div>

        <h2>üõ°Ô∏è Admin Panel</h2>
        <p>The admin panel is accessible through the Admin Dashboard route. Every request checks the authenticated user's <code>role</code> field (stored in MongoDB) and redirects to <code>/login</code> when the role is not <code>admin</code>.</p>
        <ul>
          <li>The very first user created in a fresh database is auto-promoted to <code>ADMIN</code> because the page counts existing admins and upgrades the first user if none exist.</li>
          <li>To grant admin access manually, update the user's document in the <code>users</code> collection so <code>role: &quot;ADMIN&quot;</code> (for example: <code>db.users.updateOne({ email: "you@example.com" }, { $set: { role: "ADMIN" } })</code> in the Mongo shell).</li>
          <li>Signed-in admins also see the dashboard button route to <code>/admin</code>, and the admin helper <code>src/actions/update-user-role.ts</code> provides a safe way to promote other users without touching the database directly.</li>
          <li>Make sure <code>MONGODB_URI</code> in <code>.env</code> points to your MongoDB instance; the Mongoose models define the <code>User.role</code> enum and enforce role-based access control.</li>
        </ul>

        <h2><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Verification Checklist</h2>

        <div class="callout success">
          <strong>Before starting the application, verify:</strong>
          <ul>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> All required environment variables are set</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> MongoDB connection is working (test with connection string)</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> JWT_SECRET is generated securely (minimum 32 characters)</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Server port is available (default: 5000)</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Upload directory exists and has write permissions</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Default admin credentials are configured</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Client API URL points to correct backend</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Email configuration is set up (optional, for notifications)</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> Environment file is in .gitignore (never commit secrets)</li>
            <li><svg class="icon-inline" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg> NODE_ENV is set to 'development' for local setup</li>
          </ul>
        </div>

      </section>
    </main>
  </body>
</html>
