<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Technical Overview – SchoolHub Platform</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="./styles.css" />
    <script defer src="./script.js"></script>
  </head>
  <body>
    <aside class="sidebar">
      <div class="brand">
        <img src="./screenshots/logo.svg" alt="SchoolHub Logo" />
        <div>
          <h1>SchoolHub Platform</h1>
          <p>Documentation v1.0</p>
        </div>
      </div>
      <nav>
        <a href="./index.html">Welcome</a>
        <a href="./how-to-use.html">User Guide</a>
        <a href="./technical-overview.html" class="active">Technical Overview</a>
        <a href="./api-documentation.html">API Documentation</a>
        <a href="./push-to-github.html">How to push to GitHub</a>
        <a href="./install-vercel.html">How to install on Vercel</a>
        <a href="./install-aws-ec2.html">How to install on AWS EC2</a>
        <a href="./database.html">How to setup Authentication</a>
        <a href="./mongodb-setup.html">How to create MongoDB Database</a>
        <a href="./env-setup.html">Environment Variables</a>
        <a href="./frontend-updates.html">Frontend Customization</a>
        <a href="./pricing-and-validations.html">User Roles & Permissions</a>
      </nav>
      <footer>
        <small>Built with MERN Stack (MongoDB, Express, React, Node.js)</small>
      </footer>
    </aside>

    <main class="content">
      <header class="topbar">
        <h2>Technical Overview</h2>
      </header>

      <section class="prose">
        <div class="callout info">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg> Advanced Technical Architecture:</strong> Comprehensive overview of SchoolHub Platform's enterprise-grade architecture including AI/ML integration, cloud infrastructure, payment processing, and multi-tenant design patterns.
        </div>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg> AI & Machine Learning Integration</h2>

        <h3>TensorFlow.js Person Detection</h3>
        <p>SchoolHub Platform integrates advanced AI capabilities using TensorFlow.js with the COCO-SSD model for real-time person detection:</p>

        <div class="callout success">
          <h4>Implementation Details:</h4>
          <ul>
            <li><strong>Model:</strong> COCO-SSD (Common Objects in Context - Single Shot MultiBox Detector)</li>
            <li><strong>Framework:</strong> TensorFlow.js for client-side and server-side inference</li>
            <li><strong>Use Cases:</strong> Automated person detection in uploaded images, content moderation, security features</li>
            <li><strong>Performance:</strong> Optimized for real-time processing with hardware acceleration support</li>
          </ul>
        </div>

        <h4>Technical Implementation</h4>
        <pre><code>// server/middlewares/personDetectMiddleware.js
const tf = require('@tensorflow/tfjs-node');
const cocoSsd = require('@tensorflow-models/coco-ssd');

let model = null;

const loadModel = async () => {
  if (!model) {
    model = await cocoSsd.load();
  }
  return model;
};

const detectPersons = async (imageBuffer) => {
  const model = await loadModel();
  const img = tf.node.decodeImage(imageBuffer);
  const predictions = await model.detect(img);
  img.dispose();

  return predictions.filter(pred => pred.class === 'person');
};

module.exports = { detectPersons };</code></pre>

        <h3>Content Analysis & Moderation</h3>
        <p>Automated content analysis for uploaded materials and user-generated content:</p>
        <ul>
          <li><strong>Image Analysis:</strong> Automated detection of inappropriate content</li>
          <li><strong>Text Processing:</strong> Natural language processing for content moderation</li>
          <li><strong>Automated Filtering:</strong> Real-time content validation and safety checks</li>
          <li><strong>Privacy Protection:</strong> Secure processing with data minimization</li>
        </ul>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><circle cx="12" cy="16" r="1"/><path d="M12 12v4"/></svg> Cloud Infrastructure & File Storage</h2>

        <h3>AWS S3 Integration</h3>
        <p>Enterprise-grade file storage with global CDN delivery and pre-signed URL uploads:</p>

        <div class="callout success">
          <h4>AWS Services Used:</h4>
          <ul>
            <li><strong>S3:</strong> Object storage for files, images, and documents</li>
            <li><strong>CloudFront:</strong> Global CDN for fast content delivery</li>
            <li><strong>Pre-signed URLs:</strong> Secure, time-limited upload/download links</li>
            <li><strong>Automatic Cleanup:</strong> Lifecycle policies for temporary files</li>
          </ul>
        </div>

        <h4>File Upload Implementation</h4>
        <pre><code>// server/utils/s3Utils.js
const { S3Client, PutObjectCommand, GetObjectCommand } = require('@aws-sdk/client-s3');
const { getSignedUrl } = require('@aws-sdk/s3-request-presigner');

const s3Client = new S3Client({
  region: process.env.AWS_REGION,
  credentials: {
    accessKeyId: process.env.AWS_ACCESS_KEY_ID,
    secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,
  },
});

const generateUploadUrl = async (fileName, fileType, expiresIn = 3600) => {
  const command = new PutObjectCommand({
    Bucket: process.env.AWS_S3_BUCKET,
    Key: fileName,
    ContentType: fileType,
  });

  return await getSignedUrl(s3Client, command, { expiresIn });
};

const generateDownloadUrl = async (fileName, expiresIn = 3600) => {
  const command = new GetObjectCommand({
    Bucket: process.env.AWS_S3_BUCKET,
    Key: fileName,
  });

  return await getSignedUrl(s3Client, command, { expiresIn });
};

module.exports = { generateUploadUrl, generateDownloadUrl };</code></pre>

        <h3>File Management Features</h3>
        <ul>
          <li><strong>Multi-format Support:</strong> Images, documents, videos, and archives</li>
          <li><strong>Automatic Optimization:</strong> Image compression and format conversion</li>
          <li><strong>Access Control:</strong> Organization-based file permissions</li>
          <li><strong>Backup & Recovery:</strong> Cross-region replication and versioning</li>
        </ul>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 6l3 3m0 0l3-3m-3 3V3m3 13l-3-3m0 0l-3 3m3-3v6"/></svg> Payment Integration & Subscription Management</h2>

        <h3>Stripe Integration</h3>
        <p>Complete payment processing with webhook handling and automated billing:</p>

        <div class="callout success">
          <h4>Stripe Features Implemented:</h4>
          <ul>
            <li><strong>Payment Processing:</strong> Secure credit card and digital wallet payments</li>
            <li><strong>Webhook Handling:</strong> Real-time payment status updates</li>
            <li><strong>Subscription Management:</strong> Recurring billing and plan changes</li>
            <li><strong>Invoice Generation:</strong> Automated billing and receipt generation</li>
            <li><strong>Multi-currency Support:</strong> USD, EUR, GBP, and other major currencies</li>
          </ul>
        </div>

        <h4>Webhook Implementation</h4>
        <pre><code>// server/controllers/stripeWebhookController.js
const stripe = require('stripe')(process.env.STRIPE_SECRET_KEY);
const Organization = require('../models/organizationModel');

const handleStripeWebhook = async (req, res) => {
  const sig = req.headers['stripe-signature'];
  const endpointSecret = process.env.STRIPE_WEBHOOK_SECRET;

  let event;

  try {
    event = stripe.webhooks.constructEvent(req.body, sig, endpointSecret);
  } catch (err) {
    console.error('Webhook signature verification failed:', err.message);
    return res.status(400).send('Webhook Error');
  }

  switch (event.type) {
    case 'invoice.payment_succeeded':
      await handlePaymentSuccess(event.data.object);
      break;
    case 'invoice.payment_failed':
      await handlePaymentFailure(event.data.object);
      break;
    case 'customer.subscription.updated':
      await handleSubscriptionUpdate(event.data.object);
      break;
    default:
      console.log('Unhandled event type:', event.type);
  }

  res.json({ received: true });
};

const handlePaymentSuccess = async (invoice) => {
  const organization = await Organization.findOne({ stripeCustomerId: invoice.customer });
  if (organization) {
    organization.subscriptionStatus = 'active';
    await organization.save();
  }
};

module.exports = { handleStripeWebhook };</code></pre>

        <h3>Subscription Tiers</h3>
        <p>Three distinct subscription plans with automatic feature gating:</p>
        <ul>
          <li><strong>Primary:</strong> 100 users, basic features, email support</li>
          <li><strong>High School:</strong> 500 users, advanced features, priority support</li>
          <li><strong>University:</strong> 2,000 users, enterprise features, 24/7 support</li>
        </ul>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 7h-4M8 7H4M16 17h-4M8 17H4M12 7v10M7 12h10"/></svg> Real-time Communication Architecture</h2>

        <h3>Socket.io Implementation</h3>
        <p>Advanced real-time messaging with room-based architecture:</p>

        <div class="callout success">
          <h4>Real-time Features:</h4>
          <ul>
            <li><strong>Instant Messaging:</strong> Real-time text communication between users</li>
            <li><strong>Chat Rooms:</strong> Group discussions and class channels</li>
            <li><strong>Online Status:</strong> Real-time presence indicators</li>
            <li><strong>File Sharing:</strong> Instant file transfer in chat</li>
            <li><strong>Message History:</strong> Persistent chat history and search</li>
          </ul>
        </div>

        <h4>Socket Server Implementation</h4>
        <pre><code>// server/server.js - Socket.io integration
const io = socket(server, {
  cors: {
    origin: Array.isArray(config.CORS_ORIGIN) ? config.CORS_ORIGIN : [config.CORS_ORIGIN],
    credentials: true,
  },
});

// Track online users and their socket connections
global.onlineUsers = new Map(); // userId -> socketId
global.userSockets = new Map(); // socketId -> userId

io.on("connection", (socket) => {
  socket.on("add-user", (userId) => {
    onlineUsers.set(userId, socket.id);
    userSockets.set(socket.id, userId);
  });

  socket.on("join-chat", (chatId) => {
    socket.join(chatId);
  });

  socket.on("send-msg", async (data) => {
    const { chatId, senderId, message } = data;
    // Message validation and broadcasting logic
    const messageData = {
      _id: newMessage._id,
      fromSelf: false,
      message: newMessage.message.text,
      chat: newMessage.chat,
      sender: newMessage.sender,
      createdAt: newMessage.createdAt,
      messageType: newMessage.messageType,
    };

    io.to(chatId).emit("msg-recieve", messageData);
  });

  socket.on("disconnect", () => {
    const userId = userSockets.get(socket.id);
    if (userId) {
      onlineUsers.delete(userId);
      userSockets.delete(socket.id);
    }
  });
});</code></pre>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg> Multi-Tenant Architecture</h2>

        <h3>Organization-Based Data Isolation</h3>
        <p>Complete multi-tenant architecture with database-level separation:</p>

        <div class="callout success">
          <h4>Multi-Tenancy Features:</h4>
          <ul>
            <li><strong>Data Isolation:</strong> Complete separation between organizations</li>
            <li><strong>Custom Domains:</strong> Unique domain support for each organization</li>
            <li><strong>Feature Gating:</strong> Subscription-based feature availability</li>
            <li><strong>Scalable Architecture:</strong> Horizontal scaling across organizations</li>
            <li><strong>Centralized Management:</strong> Super-admin controls across all tenants</li>
          </ul>
        </div>

        <h4>Organization Model</h4>
        <pre><code>// server/models/organizationModel.js
const organizationSchema = mongoose.Schema({
  name: {
    type: String,
    required: true,
    trim: true,
    index: true,
  },
  domain: {
    type: String,
    required: true,
    unique: true,
    lowercase: true,
    trim: true,
    index: true,
  },
  subscriptionTier: {
    type: String,
    required: true,
    enum: ["primary", "high_school", "university"],
    index: true,
  },
  subscriptionStatus: {
    type: String,
    required: true,
    enum: ["active", "inactive", "trial"],
    default: "trial",
    index: true,
  },
  maxUsers: {
    type: Number,
    required: true,
    min: 1,
    max: 10000,
  },
  features: {
    type: [String],
    default: [],
  },
  settings: {
    timezone: { type: String, default: "UTC" },
    currency: { type: String, default: "USD" },
    language: { type: String, default: "en" },
  },
}, { timestamps: true });</code></pre>

        <h3>Tenant Middleware</h3>
        <p>Automatic organization context injection for all requests:</p>

        <pre><code>// server/middlewares/tenantMiddleware.js
const Organization = require('../models/organizationModel');

const tenantMiddleware = async (req, res, next) => {
  try {
    // Extract organization from domain or header
    const host = req.headers.host || req.headers.origin;
    const organization = await Organization.findOne({
      $or: [
        { domain: host.split('.')[0] },
        { customDomain: host }
      ]
    });

    if (!organization) {
      return res.status(404).json({ message: 'Organization not found' });
    }

    // Check subscription status
    if (!organization.isActive()) {
      return res.status(403).json({ message: 'Organization subscription inactive' });
    }

    req.organization = organization;
    next();
  } catch (error) {
    console.error('Tenant middleware error:', error);
    res.status(500).json({ message: 'Internal server error' });
  }
};

module.exports = tenantMiddleware;</code></pre>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4M6 6l-2 2M18 6l2 2M12 22v-4M6 18l-2-2M18 18l2-2M2 12h4M18 12h4"/></svg> Kanban Task Management</h2>

        <h3>Professional Project Management</h3>
        <p>Complete Kanban implementation with drag-and-drop functionality:</p>

        <div class="callout success">
          <h4>Task Management Features:</h4>
          <ul>
            <li><strong>Drag & Drop Interface:</strong> Intuitive task movement between columns</li>
            <li><strong>Priority Levels:</strong> Low, Normal, High, and Critical priorities</li>
            <li><strong>Due Dates:</strong> Deadline tracking with notifications</li>
            <li><strong>Assignee Management:</strong> Task assignment to team members</li>
            <li><strong>Progress Tracking:</strong> Status updates (Open, In Progress, Testing, Close)</li>
          </ul>
        </div>

        <h4>Task Schema Design</h4>
        <pre><code>// server/models/taskModel.js
const taskSchema = mongoose.Schema({
  title: {
    type: String,
    required: true,
    trim: true,
    maxlength: 100,
  },
  description: {
    type: String,
    trim: true,
    maxlength: 1000,
  },
  status: {
    type: String,
    required: true,
    enum: ["Open", "InProgress", "Testing", "Close"],
    default: "Open",
    index: true,
  },
  priority: {
    type: String,
    required: true,
    enum: ["Low", "Normal", "High", "Critical"],
    default: "Normal",
    index: true,
  },
  assignee: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "User",
    index: true,
  },
  createdBy: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "User",
    required: true,
    index: true,
  },
  organizationId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "Organization",
    required: true,
    index: true,
  },
  tags: {
    type: [String],
    default: [],
  },
  estimate: {
    type: Number,
    min: 0,
  },
  dueDate: {
    type: Date,
  },
  rankId: {
    type: Number,
    default: 0,
    index: true,
  },
  color: {
    type: String,
    default: "#02897B",
  },
}, { timestamps: true });</code></pre>

        <h2><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg> Advanced Security & Performance</h2>

        <h3>Security Implementation</h3>
        <ul>
          <li><strong>JWT Authentication:</strong> Secure token-based authentication with expiration</li>
          <li><strong>Bcrypt Hashing:</strong> Password encryption with salt rounds</li>
          <li><strong>Input Validation:</strong> Comprehensive validation using express-validator</li>
          <li><strong>Rate Limiting:</strong> Protection against abuse and DDoS attacks</li>
          <li><strong>CORS Configuration:</strong> Secure cross-origin resource sharing</li>
          <li><strong>Helmet Security:</strong> Security headers and XSS protection</li>
        </ul>

        <h3>Performance Optimizations</h3>
        <ul>
          <li><strong>Database Indexing:</strong> Optimized queries with compound indexes</li>
          <li><strong>Caching Strategy:</strong> Redis integration for session and data caching</li>
          <li><strong>CDN Integration:</strong> Global content delivery for static assets</li>
          <li><strong>Code Splitting:</strong> Optimized bundle sizes with lazy loading</li>
          <li><strong>Compression:</strong> Gzip compression for all responses</li>
        </ul>

        <h3>Email Integration</h3>
        <p>Automated email notifications using Nodemailer:</p>
        <ul>
          <li><strong>Approval Notifications:</strong> User registration approval emails</li>
          <li><strong>Assignment Alerts:</strong> New homework and deadline reminders</li>
          <li><strong>Grade Notifications:</strong> Automatic grade and feedback emails</li>
          <li><strong>System Alerts:</strong> Maintenance and update notifications</li>
        </ul>

        <div class="callout success">
          <strong><svg class="icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg> Enterprise-Ready Architecture:</strong>
          <p>SchoolHub Platform implements production-grade architecture with comprehensive error handling, logging, monitoring, and scalability features. The system is designed to handle thousands of concurrent users across multiple organizations while maintaining data security and performance.</p>
        </div>

        <div style="text-align: center; margin: 2rem 0;">
          <a href="./how-to-use.html" class="btn">User Guide →</a>
          <a href="./env-setup.html" class="btn secondary">Environment Setup →</a>
        </div>
      </section>
    </main>
  </body>
</html>
